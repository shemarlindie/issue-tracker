!function(t){"use strict";t.module("app").controller("AppCtrl",["AppConfig","SecurityService","UserService","ProjectService","IssueService","TagService","$scope","$state","$location","$mdMedia","$mdSidenav","$mdToast","$mdDialog","$interval",function(t,e,o,a,n,i,r,c,s,d,g,l,u,f){var S=this;S.sidenav={sections:[{name:"Recent Projects",type:"heading",children:[]}],selectedSection:void 0},S.init=function(){S.loggingOut=!1,S.loginState={loading:!1,errors:{},credentials:{}},S.registerState={loading:!1,errors:{},data:{}},S.forgotPasswordState={loading:!1,errors:{},data:{}},S.activateAccountState={loading:!1,activated:!1,errors:{},data:{}},S.loadProjects()},S.loadProjects=function(){a.all(null,!0).then(function(t){S.sidenav.sections[0].children=t.data.results})["catch"](function(t){console.error("error loading sidenav projects",t)})},S.onSectionSelected=function(t){S.toggleSidenav(),c.go("app.project-detail",{id:t.id})},S.hasSidenav=function(){return c.current.data&&c.current.data.hasSidenav},S.showSidenavToggle=function(){return d("xs")||d("sm")},S.toggleSidenav=function(){g("sidenav-main").toggle()},S.login=function(){S.loginState.loading=!0,S.loginState.errors={},e.login(S.loginState.credentials).then(function(t){S.init(),c.go("app.home")})["catch"](function(t){S.loginState.errors.form=t.data.message})["finally"](function(){S.loginState.loading=!1})},S.logout=function(){S.loggingOut=!0,e.logout().then(function(t){S.init(),c.go("login")})["catch"](function(t){console.error(t)})["finally"](function(){S.loggingOut=!1})},S.register=function(){S.registerState.loading=!0,S.registerState.errors={},o.create(S.registerState.data).then(function(t){S.registerState.data={},S.registerState.form.$setPristine(),S.registerState.form.$setUntouched();var o=t.data;o.enabled?(e.setAuthData({token:o.token,user:o}),c.go("app.home")):l.showSimple("Account created! Check your email for activation instructions.")})["catch"](function(t){S.registerState.errors=t.data})["finally"](function(){S.registerState.loading=!1})},S.sendPasswordRecoveryEmail=function(){S.forgotPasswordState.loading=!0,S.forgotPasswordState.errors={};var t=l.showSimple("Sending message...");o.forgotPassword(S.forgotPasswordState.data).then(function(e){var o=e.data;o.length?u.show(u.alert({title:"Unable to send message",textContent:"The message could not be delivered to "+o.join(", ")})):(l.hide(t),l.showSimple("Message sent!"),S.forgotPasswordState.data={})})["catch"](function(t){S.forgotPasswordState.errors=t.data})["finally"](function(){S.forgotPasswordState.loading=!1,l.hide(t)})},S.resetPassword=function(){S.forgotPasswordState.loading=!0,S.forgotPasswordState.errors={},S.forgotPasswordState.data.token=c.params.token,o.resetPassword(S.forgotPasswordState.data).then(function(t){S.forgotPasswordState.data={},l.show(l.simple({textContent:"Password reset!",action:"Login"})).then(function(t){"ok"==t&&c.go("login")})})["catch"](function(t){S.forgotPasswordState.errors=t.data})["finally"](function(){S.forgotPasswordState.loading=!1})},S.activateAccount=function(){S.activateAccountState.loading=!0,S.activateAccountState.errors={},S.activateAccountState.data.token=c.params.token,o.activateAccount(S.activateAccountState.data).then(function(t){S.activateAccountState.activated=!0,S.activateAccountState.data={},l.show(l.simple({textContent:"Account activated!",action:"Login"})).then(function(t){"ok"==t&&c.go("login")})})["catch"](function(t){S.activateAccountState.errors=t.data})["finally"](function(){S.activateAccountState.loading=!1})},S.init();var h=f(function(){e.isAuthenticated()&&S.loadProjects()},t.UPDATE_INTERVAL);r.$on("$destroy",function(){f.cancel(h)})}])}(angular);
//# sourceMappingURL=../sourcemaps/app/app.ctrl.js.map
